package edu.kh.demo.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;

import jakarta.servlet.http.HttpServletRequest;
import lombok.extern.slf4j.Slf4j;

// Bean : μ¤ν”„λ§μ΄ λ§λ“¤κ³  κ΄€λ¦¬ν•λ” κ°μ²΄
@Controller // μ”μ²­/μ‘λ‹µ μ μ–΄ μ—­ν•  λ…μ‹ + Bean λ“±λ΅
@RequestMapping("param") // /param μΌλ΅ μ‹μ‘ν•λ” λ¨λ“  μ”μ²­μ„ ν„μ¬ μ»¨νΈλ΅¤λ¬λ΅ λ§¤ν•‘
@Slf4j // logλ¥Ό μ΄μ©ν• λ©”μ„Έμ§€ μ¶λ ¥ μ‹ μ‚¬μ© (Lombok λΌμ΄λΈλ¬λ¦¬μ—μ„ μ κ³µ)
public class ParameterController {

	// @RequestMapping("main")
	@GetMapping("main") // /param/main GET λ°©μ‹ μ”μ²­ λ§¤ν•‘
	public String paramMain() {
		
		// classpath: src/main/resources
		// μ ‘λ‘μ‚¬ : classpath:/templates
		// μ ‘λ―Έμ‚¬ : .html
		return "param/param-main";
		// -> src/main/resources/templates/param/param-main.html
	}
	
	/* 1. HttpServletRequest.getParameter("key") μ΄μ©
	 * λ§¤κ° λ³€μ μλ¦¬μ— λ„£μ–΄μ¤ HttpServletRequest req
	 * -> μ΄λ ‡κ² λ„£μΌλ©΄ μ‚¬μ©ν•  μ μμ
	 * 
	 * HttpServletRequest : 
	 * - μ”μ²­ ν΄λΌμ΄μ–ΈνΈ μ •λ³΄, μ μ¶λ νλΌλ―Έν„° λ“±μ„ μ €μ¥ν• κ°μ²΄
	 * - ν΄λΌμ΄μ–ΈνΈ μ”μ²­ μ‹ μƒμ„±
	 * 
	 * μ „λ‹¬ μΈμ ν•΄κ²°μ‚¬
	 * ArgumentResolver(μ „λ‹¬ μΈμ ν•΄κ²°μ‚¬) (Spring λ‚΄μ¥ κ°μ²΄)
	 * μƒμ„±ν•΄μ„ μ£Όμ…μ‹μΌμ¤(Spring μ΄)
	 * - Spring μ Controller λ©”μ„λ“ μ‘μ„± μ‹
	 * λ§¤κ°λ³€μμ— μ›ν•λ” κ°μ²΄λ¥Ό μ‘μ„±ν•λ©΄
	 * μ΅΄μ¬ν•λ” κ°μ²΄λ¥Ό λ°”μΈλ”© λλ” μ—†μΌλ©΄ μƒμ„±ν•΄μ„ λ°”μΈλ”©
	 * */
	
	@PostMapping("test1") // /param/test1 POST λ°©μ‹ μ”μ²­ λ§¤ν•‘
	public String paramTest1(HttpServletRequest req) {
		// html μ—μ„ λ„κ²¨μ¤€ κ°’ λ°›κΈ°
		String inputName = req.getParameter("inputName");
		int inputAge = Integer.parseInt(req.getParameter("inputAge"));
		// int ν•μΌλ΅ ν• λ³€ν™
		String inputAddress = req.getParameter("inputAddress");
		
//		System.out.println(inputName);
		// μ–»μ–΄μ¨ κ°’ μ΄λ ‡κ² ν™•μΈν–μ—λ”λ°
		// λ””λ²„κΉ… console μ°½μ— log λ„μ›μ¤„κ±°μ„
		
		// debug : μ½”λ“ μ¤λ¥ ν•΄κ²°
		// -> μ½”λ“ μ¤λ¥ μ—†λ”λ° μ •μƒ μν–‰μ΄ μ•λ  λ•
		// (κ°’μ΄ μ λ€λ΅ λ„μ–΄μ¤λ”μ§€ ν™•μΈν•΄λ΄μ•Όν•¨)
		// => κ°’μ΄ μ–΄λ–»κ² μƒκ²Όλ”μ§€ κ°’ μ¶”μ μ„ ν•΄μ•Όν•¨
		// log μ‚¬μ©ν•κ² λ‹¤κ³  ν΄λμ¤ λ‹¨μ— μ•λ ¤μ¤μ•Όν•¨
		
		log.debug("inputName : " + inputName);
		log.debug("inputAge : " + inputAge);
		log.debug("inputAddress : " + inputAddress);
		
		// ν•λ‚ λ” μ„¤μ •ν•΄μ¤μ•Όν•¨
		// application.properties μ— μ„¤μ • logging.level.edu.kh.demo=debug
		
		/* Console μ°½ ν™•μΈ
[2m2024-04-01T15:43:59.287+09:00[0;39m [32mDEBUG[0;39m [35m19940[0;39m [2m---[0;39m [2m[demoProject1] [p-nio-80-exec-4][0;39m [2m[0;39m[36me.k.demo.controller.ParameterController [0;39m [2m:[0;39m inputName : ν™κΈΈλ™
[2m2024-04-01T15:43:59.287+09:00[0;39m [32mDEBUG[0;39m [35m19940[0;39m [2m---[0;39m [2m[demoProject1] [p-nio-80-exec-4][0;39m [2m[0;39m[36me.k.demo.controller.ParameterController [0;39m [2m:[0;39m inputAge : 20
[2m2024-04-01T15:43:59.287+09:00[0;39m [32mDEBUG[0;39m [35m19940[0;39m [2m---[0;39m [2m[demoProject1] [p-nio-80-exec-4][0;39m [2m[0;39m[36me.k.demo.controller.ParameterController [0;39m [2m:[0;39m inputAddress : κ²½κΈ°λ„ ν‰νƒμ‹
		 * */
		
		// forward κ²½λ΅ μ¨μ£Όλ” κ±°
		
		/* Spring μ—μ„ Redirect(μ¬μ”μ²­) ν•λ” λ°©λ²•
		 * 
		 * - Controller λ©”μ„λ“ λ°ν™ κ°’μ—
		 * "redirect:μ”μ²­μ£Όμ†"; μ‘μ„±
		 * */
		return "redirect:/param/main";
	}
	
	/* 2. RequestParam μ–΄λ…Έν…μ΄μ…μ„ μ΄μ© - λ‚±κ° νλΌλ―Έν„° μ–»μ–΄μ¤κΈ°
	 * 
	 * - request κ°μ²΄λ¥Ό μ΄μ©ν• νλΌλ―Έν„° μ „λ‹¬ μ–΄λ…Έν…μ΄μ…
	 * - λ§¤κ°λ³€μ μ•μ— ν•΄λ‹Ή μ–΄λ…Έν…μ΄μ…μ„ μ‘μ„±ν•λ©΄, λ§¤κ°λ³€μμ— κ°’μ΄ μ£Όμ…λ¨
	 * - μ£Όμ…λλ” λ°μ΄ν„°λ” λ§¤κ°λ³€μμ νƒ€μ…μ— λ§κ² ν•λ³€ν™/νμ‹±μ΄ μλ™μΌλ΅ μν–‰λ¨
	 * 
	 * [κΈ°λ³Έ μ‘μ„±λ²•]
	 * @RequestParam("key") μλ£ν• λ§¤κ°λ³€μλ…
	 * */
	@PostMapping("test2")
	public String paramTest2(@RequestParam("title") String title) {
		
		log.debug("title : " + title);
		
		return "redirect:/param/main";
	}
}
